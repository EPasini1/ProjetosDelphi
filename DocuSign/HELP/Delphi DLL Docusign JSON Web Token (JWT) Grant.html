<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!-- saved from url=(0076)https://www.example-code.com/delphiDll/docusign_json_web_token_grant_jwt.asp -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Delphi DLL Docusign JSON Web Token (JWT) Grant</title>

<link href="./Delphi DLL Docusign JSON Web Token (JWT) Grant_files/detail.css" rel="stylesheet" type="text/css">
<link href="./Delphi DLL Docusign JSON Web Token (JWT) Grant_files/download.css" rel="stylesheet" type="text/css">
<link href="./Delphi DLL Docusign JSON Web Token (JWT) Grant_files/table.css" rel="stylesheet" type="text/css">
</head>

<body bgcolor="#FFFFFF">

<table width="100%" cellspacing="0" cellpadding="0" background="./Delphi DLL Docusign JSON Web Token (JWT) Grant_files/bg.GIF">
  <tbody><tr> 
    <td><a href="https://www.example-code.com/delphiDll/default.asp"><img src="./Delphi DLL Docusign JSON Web Token (JWT) Grant_files/banner.GIF" width="540" height="66" border="0" alt="Chilkat Examples"></a></td>
  </tr>
</tbody></table>

<p><font size="2">
<a href="https://www.chilkatsoft.com/">Chilkat</a> • 
<a href="https://www.example-code.com/">HOME</a> • <a href="https://www.example-code.com/dotnet-core/default.asp">.NET Core C#</a>
 • <a href="https://www.example-code.com/android/default.asp">Android™</a>
 • <a href="https://www.example-code.com/autoit/default.asp">AutoIt</a>
 • <a href="https://www.example-code.com/C/default.asp">C</a>
 • <a href="https://www.example-code.com/csharp/default.asp">C#</a>
 • <a href="https://www.example-code.com/cpp/default.asp">C++</a>
 • <a href="https://www.example-code.com/chilkat2-python/default.asp">Chilkat2-Python</a>
 • <a href="https://www.example-code.com/python/default.asp">CkPython</a>
 • <a href="https://www.example-code.com/asp/default.asp">Classic ASP</a>
 • <a href="https://www.example-code.com/dataflex/default.asp">DataFlex</a>
 • <a href="https://www.example-code.com/delphiAx/default.asp">Delphi ActiveX</a>
 • <a href="https://www.example-code.com/delphiDll/default.asp">Delphi DLL</a>
 • <a href="https://www.example-code.com/golang/default.asp">Go</a>
 • <a href="https://www.example-code.com/java/default.asp">Java</a>
 • <a href="https://www.example-code.com/lianja/default.asp">Lianja</a>
 • <a href="https://www.example-code.com/mono/default.asp">Mono C#</a>
 • <a href="https://www.example-code.com/nodejs/default.asp">Node.js</a>
 • <a href="https://www.example-code.com/objc/default.asp">Objective-C</a>
 • <a href="https://www.example-code.com/phpAx/default.asp">PHP ActiveX</a>
 • <a href="https://www.example-code.com/phpExt/default.asp">PHP Extension</a>
 • <a href="https://www.example-code.com/perl/default.asp">Perl</a>
 • <a href="https://www.example-code.com/powerbuilder/default.asp">PowerBuilder</a>
 • <a href="https://www.example-code.com/powershell/default.asp">PowerShell</a>
 • <a href="https://www.example-code.com/purebasic/default.asp">PureBasic</a>
 • <a href="https://www.example-code.com/ruby/default.asp">Ruby</a>
 • <a href="https://www.example-code.com/sql/default.asp">SQL Server</a>
 • <a href="https://www.example-code.com/swift/default.asp">Swift 2</a>
 • <a href="https://www.example-code.com/swift3/default.asp">Swift 3,4,5...</a>
 • <a href="https://www.example-code.com/tcl/default.asp">Tcl</a>
 • <a href="https://www.example-code.com/unicodeC/default.asp">Unicode C</a>
 • <a href="https://www.example-code.com/unicodeCpp/default.asp">Unicode C++</a>
 • <a href="https://www.example-code.com/vbnet/default.asp">VB.NET</a>
 • <a href="https://www.example-code.com/vbscript/default.asp">VBScript</a>
 • <a href="https://www.example-code.com/vb6/default.asp">Visual Basic 6.0</a>
 • <a href="https://www.example-code.com/foxpro/default.asp">Visual FoxPro</a>
 • <a href="https://www.example-code.com/xojo/default.asp">Xojo Plugin</a>

</font>
</p>
 
<table width="100%" cellspacing="0" cellpadding="3">
  <tbody><tr> 
    <td width="160" valign="top">      
<table width="320" border="1" cellspacing="0" cellpadding="5" bgcolor="#FFFFFF" bordercolor="#7F2AB2" align="left">
  <tbody><tr valign="top" bgcolor="#7F2AB2"> 
    <td colspan="2"> 
      <div align="center"><font size="2" color="#FFFFFF"><b>Delphi DLL Web API Examples</b></font></div>
          </td>
        </tr>
  <tr valign="top"> 
    <td> 
<p><font color="#333333" size="2"><b> 
<a href="https://www.example-code.com/delphiDll/default.asp">Primary Categories</a><br><br>
<a href="https://www.example-code.com/delphiDll/abn_amro.asp">ABN AMRO</a><br>
<a href="https://www.example-code.com/delphiDll/awsSecretsManager.asp">AWS Secrets Manager</a><br>
<a href="https://www.example-code.com/delphiDll/aws_sts.asp">AWS Security Token Service</a><br>
<a href="https://www.example-code.com/delphiDll/aws_translate.asp">AWS Translate</a><br>
<a href="https://www.example-code.com/delphiDll/activix.asp">Activix CRM</a><br>
<a href="https://www.example-code.com/delphiDll/adyen.asp">Adyen</a><br>
<a href="https://www.example-code.com/delphiDll/aliyun_oss.asp">Alibaba Cloud OSS</a><br>
<a href="https://www.example-code.com/delphiDll/cognito.asp">Amazon Cognito</a><br>
<a href="https://www.example-code.com/delphiDll/dynamodb.asp">Amazon DynamoDB</a><br>
<a href="https://www.example-code.com/delphiDll/mws.asp">Amazon MWS</a><br>
<a href="https://www.example-code.com/delphiDll/amazon_pay.asp">Amazon Pay</a><br>
<a href="https://www.example-code.com/delphiDll/rekognition.asp">Amazon Rekognition</a><br>
<a href="https://www.example-code.com/delphiDll/sp_api.asp">Amazon SP-API</a><br>
<a href="https://www.example-code.com/delphiDll/voiceId.asp">Amazon Voice ID</a><br>
<a href="https://www.example-code.com/delphiDll/aruba_fatturazione.asp">Aruba Fatturazione</a><br>
<a href="https://www.example-code.com/delphiDll/azure_maps.asp">Azure Maps</a><br>
<a href="https://www.example-code.com/delphiDll/azure_monitor.asp">Azure Monitor</a><br>
<a href="https://www.example-code.com/delphiDll/azure_oauth2.asp">Azure OAuth2</a><br>
<a href="https://www.example-code.com/delphiDll/azure_storage_accounts.asp">Azure Storage Accounts</a><br>
<a href="https://www.example-code.com/delphiDll/backblaze_s3.asp">Backblaze S3</a><br>
<a href="https://www.example-code.com/delphiDll/banco_inter.asp">Banco Inter</a><br>
<a href="https://www.example-code.com/delphiDll/bitfinex_v2_rest.asp">Bitfinex v2 REST</a><br>
<a href="https://www.example-code.com/delphiDll/bluzone.asp">Bluzone</a><br>
<a href="https://www.example-code.com/delphiDll/bricklink.asp">BrickLink</a><br>
<a href="https://www.example-code.com/delphiDll/bunny.asp">Bunny CDN</a><br>
<a href="https://www.example-code.com/delphiDll/callrail.asp">CallRail</a><br>
<a href="https://www.example-code.com/delphiDll/cardConnect.asp">CardConnect</a><br>
<a href="https://www.example-code.com/delphiDll/cerved.asp">Cerved</a><br>
<a href="https://www.example-code.com/delphiDll/clickBank.asp">ClickBank</a><br>
<a href="https://www.example-code.com/delphiDll/clickatell.asp">Clickatell</a><br>
<a href="https://www.example-code.com/delphiDll/cloudfare.asp">Cloudfare</a><br>
<a href="https://www.example-code.com/delphiDll/constantcontact.asp">Constant Contact</a><br>
<a href="https://www.example-code.com/delphiDll/docusign.asp">DocuSign</a><br>
<a href="https://www.example-code.com/delphiDll/duo.asp">Duo Auth MFA</a><br>
<a href="https://www.example-code.com/delphiDll/etrade.asp">ETrade</a><br>
<a href="https://www.example-code.com/delphiDll/ecwid.asp">Ecwid</a><br>
<a href="https://www.example-code.com/delphiDll/itida.asp">Egypt ITIDA</a><br>
<a href="https://www.example-code.com/delphiDll/egypt_ereceipt.asp">Egypt eReceipt</a><br>
<a href="https://www.example-code.com/delphiDll/etsy.asp">Etsy</a><br>
<a href="https://www.example-code.com/delphiDll/facebook.asp">Facebook</a><br>
<a href="https://www.example-code.com/delphiDll/faire.asp">Faire</a><br>
<a href="https://www.example-code.com/delphiDll/frame_io.asp">Frame.io</a><br>
<a href="https://www.example-code.com/delphiDll/geoop.asp">GeoOp</a><br>
<a href="https://www.example-code.com/delphiDll/getHarvest.asp">GetHarvest</a><br>
<a href="https://www.example-code.com/delphiDll/globalpayments.asp">Global Payments</a><br>
<a href="https://www.example-code.com/delphiDll/google_people_api.asp">Google People</a><br>
<a href="https://www.example-code.com/delphiDll/googleSearchConsole.asp">Google Search Console</a><br>
<a href="https://www.example-code.com/delphiDll/googleTranslate.asp">Google Translate</a><br>
<a href="https://www.example-code.com/delphiDll/nav_invoice.asp">Hungary NAV Invoicing</a><br>
<a href="https://www.example-code.com/delphiDll/ibm_text_to_speech.asp">IBM Text to Speech</a><br>
<a href="https://www.example-code.com/delphiDll/ibanity.asp">Ibanity</a><br>
<a href="https://www.example-code.com/delphiDll/intakeq.asp">IntakeQ</a><br>
<a href="https://www.example-code.com/delphiDll/jira.asp">Jira</a><br>
<a href="https://www.example-code.com/delphiDll/lightspeed.asp">Lightspeed</a><br>
<a href="https://www.example-code.com/delphiDll/myob.asp">MYOB</a><br>
<a href="https://www.example-code.com/delphiDll/magento.asp">Magento</a><br>
<a href="https://www.example-code.com/delphiDll/mailgun.asp">Mailgun</a><br>
<a href="https://www.example-code.com/delphiDll/mastercard.asp">Mastercard</a><br>
<a href="https://www.example-code.com/delphiDll/medTunnel.asp">MedTunnel</a><br>
</b></font></p></td><td><p><font color="#333333" size="2"><b><a href="https://www.example-code.com/delphiDll/mercadolibre.asp">MercadoLibre</a><br>
<a href="https://www.example-code.com/delphiDll/messagemedia.asp">MessageMedia</a><br>
<a href="https://www.example-code.com/delphiDll/msGraphCalendar.asp">Microsoft Calendar</a><br>
<a href="https://www.example-code.com/delphiDll/msGraphGroup.asp">Microsoft Group</a><br>
<a href="https://www.example-code.com/delphiDll/msGraphTaskPlans.asp">Microsoft Tasks and Plans</a><br>
<a href="https://www.example-code.com/delphiDll/teams.asp">Microsoft Teams</a><br>
<a href="https://www.example-code.com/delphiDll/moodys.asp">Moody's</a><br>
<a href="https://www.example-code.com/delphiDll/okta_oauth_oidc.asp">Okta OAuth/OIDC</a><br>
<a href="https://www.example-code.com/delphiDll/onelogin_oidc.asp">OneLogin OIDC</a><br>
<a href="https://www.example-code.com/delphiDll/onenote.asp">OneNote</a><br>
<a href="https://www.example-code.com/delphiDll/openai.asp">OpenAI ChatGPT</a><br>
<a href="https://www.example-code.com/delphiDll/PRODA.asp">PRODA</a><br>
<a href="https://www.example-code.com/delphiDll/paypal.asp">PayPal</a><br>
<a href="https://www.example-code.com/delphiDll/paynow.asp">Paynow.pl</a><br>
<a href="https://www.example-code.com/delphiDll/peoplevox.asp">Peoplevox</a><br>
<a href="https://www.example-code.com/delphiDll/populi.asp">Populi</a><br>
<a href="https://www.example-code.com/delphiDll/quickbooks.asp">QuickBooks</a><br>
<a href="https://www.example-code.com/delphiDll/rabobank.asp">Rabobank</a><br>
<a href="https://www.example-code.com/delphiDll/refinitiv.asp">Refinitiv</a><br>
<a href="https://www.example-code.com/delphiDll/royalMail.asp">Royal Mail OBA</a><br>
<a href="https://www.example-code.com/delphiDll/scis.asp">SCiS Schools Catalogue</a><br>
<a href="https://www.example-code.com/delphiDll/sii.asp">SII Chile</a><br>
<a href="https://www.example-code.com/delphiDll/smsapi.asp">SMSAPI</a><br>
<a href="https://www.example-code.com/delphiDll/finkok.asp">SOAP finkok.com</a><br>
<a href="https://www.example-code.com/delphiDll/sendgrid.asp">SendGrid</a><br>
<a href="https://www.example-code.com/delphiDll/shippo.asp">Shippo</a><br>
<a href="https://www.example-code.com/delphiDll/shopify.asp">Shopify</a><br>
<a href="https://www.example-code.com/delphiDll/shopware.asp">Shopware</a><br>
<a href="https://www.example-code.com/delphiDll/shopware6.asp">Shopware 6</a><br>
<a href="https://www.example-code.com/delphiDll/simpletexting.asp">SimpleTexting</a><br>
<a href="https://www.example-code.com/delphiDll/square.asp">Square</a><br>
<a href="https://www.example-code.com/delphiDll/stripe.asp">Stripe</a><br>
<a href="https://www.example-code.com/delphiDll/sugarCRM.asp">SugarCRM</a><br>
<a href="https://www.example-code.com/delphiDll/ticketBAI.asp">TicketBAI</a><br>
<a href="https://www.example-code.com/delphiDll/trello.asp">Trello</a><br>
<a href="https://www.example-code.com/delphiDll/twilio.asp">Twilio</a><br>
<a href="https://www.example-code.com/delphiDll/twitter_v2.asp">Twitter API v2</a><br>
<a href="https://www.example-code.com/delphiDll/twitter.asp">Twitter v1</a><br>
<a href="https://www.example-code.com/delphiDll/ups.asp">UPS</a><br>
<a href="https://www.example-code.com/delphiDll/UniPin.asp">UniPin</a><br>
<a href="https://www.example-code.com/delphiDll/voicebase.asp">VoiceBase</a><br>
<a href="https://www.example-code.com/delphiDll/vonage.asp">Vonage</a><br>
<a href="https://www.example-code.com/delphiDll/watrend.asp">WaTrend</a><br>
<a href="https://www.example-code.com/delphiDll/walmart.asp">Walmart</a><br>
<a href="https://www.example-code.com/delphiDll/walmart_v3.asp">Walmart v3</a><br>
<a href="https://www.example-code.com/delphiDll/wasabi.asp">Wasabi</a><br>
<a href="https://www.example-code.com/delphiDll/whatsapp.asp">WhatsApp</a><br>
<a href="https://www.example-code.com/delphiDll/wix.asp">WiX</a><br>
<a href="https://www.example-code.com/delphiDll/woocommerce.asp">WooCommerce</a><br>
<a href="https://www.example-code.com/delphiDll/wordpress.asp">WordPress</a><br>
<a href="https://www.example-code.com/delphiDll/xero.asp">Xero</a><br>
<a href="https://www.example-code.com/delphiDll/yahooMail.asp">Yahoo Mail</a><br>
<a href="https://www.example-code.com/delphiDll/yapily.asp">Yapily</a><br>
<a href="https://www.example-code.com/delphiDll/yousign.asp">Yousign</a><br>
<a href="https://www.example-code.com/delphiDll/zatca.asp">ZATCA</a><br>
<a href="https://www.example-code.com/delphiDll/zendesk.asp">Zendesk</a><br>
<a href="https://www.example-code.com/delphiDll/zoom.asp">Zoom</a><br>
<a href="https://www.example-code.com/delphiDll/aaa_misc.asp">_Miscellaneous_</a><br>
<a href="https://www.example-code.com/delphiDll/ebay.asp">eBay</a><br>
<a href="https://www.example-code.com/delphiDll/effectconnect.asp">effectconnect</a><br>
<a href="https://www.example-code.com/delphiDll/hacienda_cr.asp">hacienda.go.cr</a><br>

</b></font></p>
<p></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
          </td>
        </tr>
      </tbody></table>
      
      
 
</td>
    <td valign="top"> 
      <h1><b>(Delphi DLL) Docusign JSON Web Token (JWT) Grant</b></h1>
      <p>Demonstrates how to obtain an access token using the JSON Web Token (JWT) Grant.  This is good for service integrations where authorization and authentication is automated and cannot have interactive Docusign account owner interaction.   Consent for the access is obtained beforehand in various ways.  See <a href="https://developers.docusign.com/esign-rest-api/guides/authentication/obtaining-consent">Obtaining Consent</a>.</p><p>For more information, see <a href="https://developers.docusign.com/esign-rest-api/guides/authentication/oauth2-jsonwebtoken">https://developers.docusign.com/esign-rest-api/guides/authentication/oauth2-jsonwebtoken</a></p>
		<blockquote><table class="reference" width="500"><tbody><tr><td valign="top" colspan="3">
   <h2 id="subhdr">Chilkat for Delphi Downloads</h2>
		<p class="button"><a href="http://www.chilkatsoft.com/delphiDll.asp">Chilkat non-ActiveX DLL for Delphi</a></p>
		<p class="button"><a href="http://www.chilkatsoft.com/downloads_ActiveX.asp">Chilkat ActiveX DLL for Delphi</a></p>
		<p>* The examples here use the non-ActiveX DLL.</p>
   </td></tr>
</tbody></table>



</blockquote>
      <pre id="exCode"><span id="keyw">uses</span>
    Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
    Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Jwt, HttpResponse, HttpRequest, JsonObject, PrivateKey, Http;

...

<span id="keyw">procedure</span> TForm1.Button1Click(Sender: TObject);
<span id="keyw">var</span>
privKey: <a target="_top" href="http://www.chilkatsoft.com/refdoc/dd_CkPrivateKeyRef.html">HCkPrivateKey</a>;
success: <span id="keyw">Boolean</span>;
jwt: <a target="_top" href="http://www.chilkatsoft.com/refdoc/dd_CkJwtRef.html">HCkJwt</a>;
jose: <a target="_top" href="http://www.chilkatsoft.com/refdoc/dd_CkJsonObjectRef.html">HCkJsonObject</a>;
claims: <a target="_top" href="http://www.chilkatsoft.com/refdoc/dd_CkJsonObjectRef.html">HCkJsonObject</a>;
curDateTime: <span id="keyw">Integer</span>;
token: <span id="keyw">PWideChar</span>;
http: <a target="_top" href="http://www.chilkatsoft.com/refdoc/dd_CkHttpRef.html">HCkHttp</a>;
req: <a target="_top" href="http://www.chilkatsoft.com/refdoc/dd_CkHttpRequestRef.html">HCkHttpRequest</a>;
resp: <a target="_top" href="http://www.chilkatsoft.com/refdoc/dd_CkHttpResponseRef.html">HCkHttpResponse</a>;

<span id="keyw">begin</span>
<span id="cmt">// This example requires the Chilkat API to have been previously unlocked.</span>
<span id="cmt">// See <a href="https://www.example-code.com/delphiDll/global_unlock.asp">Global Unlock Sample</a> for sample code.</span>

<span id="cmt">// 1. Assume we have already requested and obtained application consent.</span>
<span id="cmt">//    (See <a href="https://www.example-code.com/delphiDll/docusign_request_impersonation_consent.asp">Request Docusign Application Consent</a></span>
<span id="cmt">// </span>
<span id="cmt">// 2. Create a JWT Token.</span>
<span id="cmt">// </span>
privKey := CkPrivateKey_Create();

<span id="cmt">// Load an RSA private key from a PEM file.</span>
success := <span id="dtyp">CkPrivateKey_LoadPemFile</span>(privKey,<span id="lit">'qa_data/pem/docusign_private_rsa_key.pem'</span>);
<span id="keyw">if</span> (success &lt;&gt; <span id="lit">True</span>) <span id="keyw">then</span>
  <span id="keyw">begin</span>
    Memo1.Lines.Add(<span id="dtyp">CkPrivateKey__lastErrorText</span>(privKey));
    Exit;
  <span id="keyw">end</span>;

jwt := CkJwt_Create();

<span id="cmt">// Build the JOSE header</span>
jose := CkJsonObject_Create();
<span id="cmt">// Use RS256.  Pass the string "RS384" or "RS512" to use RSA with SHA-384 or SHA-512.</span>
success := <span id="dtyp">CkJsonObject_AppendString</span>(jose,<span id="lit">'alg'</span>,<span id="lit">'RS256'</span>);
success := <span id="dtyp">CkJsonObject_AppendString</span>(jose,<span id="lit">'typ'</span>,<span id="lit">'JWT'</span>);

<span id="cmt">// Now build the JWT claims (also known as the payload)</span>
claims := CkJsonObject_Create();

<span id="cmt">// Replace these with actual values.</span>
<span id="cmt">// The client ID is also known as the "integration key" in Docusign.</span>
success := <span id="dtyp">CkJsonObject_AppendString</span>(claims,<span id="lit">'iss'</span>,<span id="lit">'MY_DOCUSIGN_CLIENT_ID'</span>);
<span id="cmt">// In your DocuSign Admin/Account/UserProfile, this is the API Username, such as 14612117-2530-4982-8c49-ba8766303272</span>
success := <span id="dtyp">CkJsonObject_AppendString</span>(claims,<span id="lit">'sub'</span>,<span id="lit">'DOCUSIGN_USER_ID'</span>);
success := <span id="dtyp">CkJsonObject_AppendString</span>(claims,<span id="lit">'aud'</span>,<span id="lit">'account-d.docusign.com'</span>);
success := <span id="dtyp">CkJsonObject_AppendString</span>(claims,<span id="lit">'scope'</span>,<span id="lit">'signature'</span>);

<span id="cmt">// Set the timestamp of when the JWT was created to now.</span>
curDateTime := <span id="dtyp">CkJwt_GenNumericDate</span>(jwt,<span id="lit">0</span>);
success := <span id="dtyp">CkJsonObject_AddIntAt</span>(claims,<span id="lit">-1</span>,<span id="lit">'iat'</span>,curDateTime);

<span id="cmt">// Set the "not process before" timestamp to now.</span>
success := <span id="dtyp">CkJsonObject_AddIntAt</span>(claims,<span id="lit">-1</span>,<span id="lit">'nbf'</span>,curDateTime);

<span id="cmt">// Set the timestamp defining an expiration time (end time) for the token</span>
<span id="cmt">// to be now + 1 hour (3600 seconds)</span>
success := <span id="dtyp">CkJsonObject_AddIntAt</span>(claims,<span id="lit">-1</span>,<span id="lit">'exp'</span>,curDateTime + <span id="lit">3600</span>);

<span id="cmt">// Produce the smallest possible JWT:</span>
<span id="dtyp">CkJwt_putAutoCompact</span>(jwt,<span id="lit">True</span>);

<span id="cmt">// Create the JWT token.  This is where the RSA signature is created.</span>
token := <span id="dtyp">CkJwt__createJwtPk</span>(jwt,<span id="dtyp">CkJsonObject__emit</span>(jose),<span id="dtyp">CkJsonObject__emit</span>(claims),privKey);

Memo1.Lines.Add(token);

<span id="cmt">// Do the following CURL statement to get the response JSON which contains the access token.</span>
<span id="cmt">// curl --data "grant_type=urn:ietf:params:oauth:grant-type:jwt-bearer&amp;assertion=YOUR_JSON_WEB_TOKEN" </span>
<span id="cmt">//      --request POST https://account-d.docusign.com/oauth/token</span>
http := CkHttp_Create();

req := CkHttpRequest_Create();
<span id="dtyp">CkHttpRequest_AddParam</span>(req,<span id="lit">'grant_type'</span>,<span id="lit">'urn:ietf:params:oauth:grant-type:jwt-bearer'</span>);
<span id="dtyp">CkHttpRequest_AddParam</span>(req,<span id="lit">'assertion'</span>,token);

resp := <span id="dtyp">CkHttp_PostUrlEncoded</span>(http,<span id="lit">'https://account-d.docusign.com/oauth/token'</span>,req);
<span id="keyw">if</span> (<span id="dtyp">CkHttp_getLastMethodSuccess</span>(http) = <span id="lit">False</span>) <span id="keyw">then</span>
  <span id="keyw">begin</span>
    Memo1.Lines.Add(<span id="dtyp">CkHttp__lastErrorText</span>(http));
    Exit;
  <span id="keyw">end</span>;

Memo1.Lines.Add(<span id="lit">'response status = '</span> + IntToStr(<span id="dtyp">CkHttpResponse_getStatusCode</span>(resp)));
<span id="keyw">if</span> (<span id="dtyp">CkHttpResponse_getStatusCode</span>(resp) &lt;&gt; <span id="lit">200</span>) <span id="keyw">then</span>
  <span id="keyw">begin</span>
    Memo1.Lines.Add(<span id="dtyp">CkHttpResponse__bodyStr</span>(resp));
    Memo1.Lines.Add(<span id="lit">'Failed.'</span>);
  <span id="keyw">end</span>
<span id="keyw">else</span>
  <span id="keyw">begin</span>
    <span id="cmt">// Save the access token to a file for use in subsequent requests..</span>
    <span id="cmt">// (Or you may simply persiste the access token in memory for your applicaton to use for subsequent REST API calls..)</span>
    success := <span id="dtyp">CkHttpResponse_SaveBodyText</span>(resp,<span id="lit">True</span>,<span id="lit">'qa_data/tokens/docusign.json'</span>);
    Memo1.Lines.Add(<span id="dtyp">CkHttpResponse__bodyStr</span>(resp));
    Memo1.Lines.Add(<span id="lit">'Success.'</span>);
  <span id="keyw">end</span>;

CkHttpResponse_Dispose(resp);

CkPrivateKey_Dispose(privKey);
CkJwt_Dispose(jwt);
CkJsonObject_Dispose(jose);
CkJsonObject_Dispose(claims);
CkHttp_Dispose(http);
CkHttpRequest_Dispose(req);

<span id="keyw">end</span>;

</pre>
    </td>
  </tr>
</tbody></table>

<table width="100%" border="0" cellspacing="0" cellpadding="3" bgcolor="#7F2AB2">
  <tbody><tr>
    <td>&nbsp; </td>
  </tr>
</tbody></table>

<p align="center"><font size="1" color="#999999">© 
  2000-2023 Chilkat Software, Inc. All Rights Reserved.</font></p>
 


</body></html>
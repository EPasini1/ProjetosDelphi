<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2//EN">
<!-- saved from url=(0077)https://www.example-code.com/delphiDll/docusign_add_documents_to_envelope.asp -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Delphi DLL DocuSign Add Documents to a Draft Envelope</title>

<link href="./Delphi DLL DocuSign Add Documents to a Draft Envelope_files/detail.css" rel="stylesheet" type="text/css">
<link href="./Delphi DLL DocuSign Add Documents to a Draft Envelope_files/download.css" rel="stylesheet" type="text/css">
<link href="./Delphi DLL DocuSign Add Documents to a Draft Envelope_files/table.css" rel="stylesheet" type="text/css">
</head>

<body bgcolor="#FFFFFF">

<table width="100%" cellspacing="0" cellpadding="0" background="./Delphi DLL DocuSign Add Documents to a Draft Envelope_files/bg.GIF">
  <tbody><tr> 
    <td><a href="https://www.example-code.com/delphiDll/default.asp"><img src="./Delphi DLL DocuSign Add Documents to a Draft Envelope_files/banner.GIF" width="540" height="66" border="0" alt="Chilkat Examples"></a></td>
  </tr>
</tbody></table>

<p><font size="2">
<a href="https://www.chilkatsoft.com/">Chilkat</a> • 
<a href="https://www.example-code.com/">HOME</a> • <a href="https://www.example-code.com/dotnet-core/default.asp">.NET Core C#</a>
 • <a href="https://www.example-code.com/android/default.asp">Android™</a>
 • <a href="https://www.example-code.com/autoit/default.asp">AutoIt</a>
 • <a href="https://www.example-code.com/C/default.asp">C</a>
 • <a href="https://www.example-code.com/csharp/default.asp">C#</a>
 • <a href="https://www.example-code.com/cpp/default.asp">C++</a>
 • <a href="https://www.example-code.com/chilkat2-python/default.asp">Chilkat2-Python</a>
 • <a href="https://www.example-code.com/python/default.asp">CkPython</a>
 • <a href="https://www.example-code.com/asp/default.asp">Classic ASP</a>
 • <a href="https://www.example-code.com/dataflex/default.asp">DataFlex</a>
 • <a href="https://www.example-code.com/delphiAx/default.asp">Delphi ActiveX</a>
 • <a href="https://www.example-code.com/delphiDll/default.asp">Delphi DLL</a>
 • <a href="https://www.example-code.com/golang/default.asp">Go</a>
 • <a href="https://www.example-code.com/java/default.asp">Java</a>
 • <a href="https://www.example-code.com/lianja/default.asp">Lianja</a>
 • <a href="https://www.example-code.com/mono/default.asp">Mono C#</a>
 • <a href="https://www.example-code.com/nodejs/default.asp">Node.js</a>
 • <a href="https://www.example-code.com/objc/default.asp">Objective-C</a>
 • <a href="https://www.example-code.com/phpAx/default.asp">PHP ActiveX</a>
 • <a href="https://www.example-code.com/phpExt/default.asp">PHP Extension</a>
 • <a href="https://www.example-code.com/perl/default.asp">Perl</a>
 • <a href="https://www.example-code.com/powerbuilder/default.asp">PowerBuilder</a>
 • <a href="https://www.example-code.com/powershell/default.asp">PowerShell</a>
 • <a href="https://www.example-code.com/purebasic/default.asp">PureBasic</a>
 • <a href="https://www.example-code.com/ruby/default.asp">Ruby</a>
 • <a href="https://www.example-code.com/sql/default.asp">SQL Server</a>
 • <a href="https://www.example-code.com/swift/default.asp">Swift 2</a>
 • <a href="https://www.example-code.com/swift3/default.asp">Swift 3,4,5...</a>
 • <a href="https://www.example-code.com/tcl/default.asp">Tcl</a>
 • <a href="https://www.example-code.com/unicodeC/default.asp">Unicode C</a>
 • <a href="https://www.example-code.com/unicodeCpp/default.asp">Unicode C++</a>
 • <a href="https://www.example-code.com/vbnet/default.asp">VB.NET</a>
 • <a href="https://www.example-code.com/vbscript/default.asp">VBScript</a>
 • <a href="https://www.example-code.com/vb6/default.asp">Visual Basic 6.0</a>
 • <a href="https://www.example-code.com/foxpro/default.asp">Visual FoxPro</a>
 • <a href="https://www.example-code.com/xojo/default.asp">Xojo Plugin</a>

</font>
</p>
 
<table width="100%" cellspacing="0" cellpadding="3">
  <tbody><tr> 
    <td width="160" valign="top">      
<table width="320" border="1" cellspacing="0" cellpadding="5" bgcolor="#FFFFFF" bordercolor="#7F2AB2" align="left">
  <tbody><tr valign="top" bgcolor="#7F2AB2"> 
    <td colspan="2"> 
      <div align="center"><font size="2" color="#FFFFFF"><b>Delphi DLL Web API Examples</b></font></div>
          </td>
        </tr>
  <tr valign="top"> 
    <td> 
<p><font color="#333333" size="2"><b> 
<a href="https://www.example-code.com/delphiDll/default.asp">Primary Categories</a><br><br>
<a href="https://www.example-code.com/delphiDll/abn_amro.asp">ABN AMRO</a><br>
<a href="https://www.example-code.com/delphiDll/awsSecretsManager.asp">AWS Secrets Manager</a><br>
<a href="https://www.example-code.com/delphiDll/aws_sts.asp">AWS Security Token Service</a><br>
<a href="https://www.example-code.com/delphiDll/aws_translate.asp">AWS Translate</a><br>
<a href="https://www.example-code.com/delphiDll/activix.asp">Activix CRM</a><br>
<a href="https://www.example-code.com/delphiDll/adyen.asp">Adyen</a><br>
<a href="https://www.example-code.com/delphiDll/aliyun_oss.asp">Alibaba Cloud OSS</a><br>
<a href="https://www.example-code.com/delphiDll/cognito.asp">Amazon Cognito</a><br>
<a href="https://www.example-code.com/delphiDll/dynamodb.asp">Amazon DynamoDB</a><br>
<a href="https://www.example-code.com/delphiDll/mws.asp">Amazon MWS</a><br>
<a href="https://www.example-code.com/delphiDll/amazon_pay.asp">Amazon Pay</a><br>
<a href="https://www.example-code.com/delphiDll/rekognition.asp">Amazon Rekognition</a><br>
<a href="https://www.example-code.com/delphiDll/sp_api.asp">Amazon SP-API</a><br>
<a href="https://www.example-code.com/delphiDll/voiceId.asp">Amazon Voice ID</a><br>
<a href="https://www.example-code.com/delphiDll/aruba_fatturazione.asp">Aruba Fatturazione</a><br>
<a href="https://www.example-code.com/delphiDll/azure_maps.asp">Azure Maps</a><br>
<a href="https://www.example-code.com/delphiDll/azure_monitor.asp">Azure Monitor</a><br>
<a href="https://www.example-code.com/delphiDll/azure_oauth2.asp">Azure OAuth2</a><br>
<a href="https://www.example-code.com/delphiDll/azure_storage_accounts.asp">Azure Storage Accounts</a><br>
<a href="https://www.example-code.com/delphiDll/backblaze_s3.asp">Backblaze S3</a><br>
<a href="https://www.example-code.com/delphiDll/banco_inter.asp">Banco Inter</a><br>
<a href="https://www.example-code.com/delphiDll/bitfinex_v2_rest.asp">Bitfinex v2 REST</a><br>
<a href="https://www.example-code.com/delphiDll/bluzone.asp">Bluzone</a><br>
<a href="https://www.example-code.com/delphiDll/bricklink.asp">BrickLink</a><br>
<a href="https://www.example-code.com/delphiDll/bunny.asp">Bunny CDN</a><br>
<a href="https://www.example-code.com/delphiDll/callrail.asp">CallRail</a><br>
<a href="https://www.example-code.com/delphiDll/cardConnect.asp">CardConnect</a><br>
<a href="https://www.example-code.com/delphiDll/cerved.asp">Cerved</a><br>
<a href="https://www.example-code.com/delphiDll/clickBank.asp">ClickBank</a><br>
<a href="https://www.example-code.com/delphiDll/clickatell.asp">Clickatell</a><br>
<a href="https://www.example-code.com/delphiDll/cloudfare.asp">Cloudfare</a><br>
<a href="https://www.example-code.com/delphiDll/constantcontact.asp">Constant Contact</a><br>
<a href="https://www.example-code.com/delphiDll/docusign.asp">DocuSign</a><br>
<a href="https://www.example-code.com/delphiDll/duo.asp">Duo Auth MFA</a><br>
<a href="https://www.example-code.com/delphiDll/etrade.asp">ETrade</a><br>
<a href="https://www.example-code.com/delphiDll/ecwid.asp">Ecwid</a><br>
<a href="https://www.example-code.com/delphiDll/itida.asp">Egypt ITIDA</a><br>
<a href="https://www.example-code.com/delphiDll/egypt_ereceipt.asp">Egypt eReceipt</a><br>
<a href="https://www.example-code.com/delphiDll/etsy.asp">Etsy</a><br>
<a href="https://www.example-code.com/delphiDll/facebook.asp">Facebook</a><br>
<a href="https://www.example-code.com/delphiDll/faire.asp">Faire</a><br>
<a href="https://www.example-code.com/delphiDll/frame_io.asp">Frame.io</a><br>
<a href="https://www.example-code.com/delphiDll/geoop.asp">GeoOp</a><br>
<a href="https://www.example-code.com/delphiDll/getHarvest.asp">GetHarvest</a><br>
<a href="https://www.example-code.com/delphiDll/globalpayments.asp">Global Payments</a><br>
<a href="https://www.example-code.com/delphiDll/google_people_api.asp">Google People</a><br>
<a href="https://www.example-code.com/delphiDll/googleSearchConsole.asp">Google Search Console</a><br>
<a href="https://www.example-code.com/delphiDll/googleTranslate.asp">Google Translate</a><br>
<a href="https://www.example-code.com/delphiDll/nav_invoice.asp">Hungary NAV Invoicing</a><br>
<a href="https://www.example-code.com/delphiDll/ibm_text_to_speech.asp">IBM Text to Speech</a><br>
<a href="https://www.example-code.com/delphiDll/ibanity.asp">Ibanity</a><br>
<a href="https://www.example-code.com/delphiDll/intakeq.asp">IntakeQ</a><br>
<a href="https://www.example-code.com/delphiDll/jira.asp">Jira</a><br>
<a href="https://www.example-code.com/delphiDll/lightspeed.asp">Lightspeed</a><br>
<a href="https://www.example-code.com/delphiDll/myob.asp">MYOB</a><br>
<a href="https://www.example-code.com/delphiDll/magento.asp">Magento</a><br>
<a href="https://www.example-code.com/delphiDll/mailgun.asp">Mailgun</a><br>
<a href="https://www.example-code.com/delphiDll/mastercard.asp">Mastercard</a><br>
<a href="https://www.example-code.com/delphiDll/medTunnel.asp">MedTunnel</a><br>
</b></font></p></td><td><p><font color="#333333" size="2"><b><a href="https://www.example-code.com/delphiDll/mercadolibre.asp">MercadoLibre</a><br>
<a href="https://www.example-code.com/delphiDll/messagemedia.asp">MessageMedia</a><br>
<a href="https://www.example-code.com/delphiDll/msGraphCalendar.asp">Microsoft Calendar</a><br>
<a href="https://www.example-code.com/delphiDll/msGraphGroup.asp">Microsoft Group</a><br>
<a href="https://www.example-code.com/delphiDll/msGraphTaskPlans.asp">Microsoft Tasks and Plans</a><br>
<a href="https://www.example-code.com/delphiDll/teams.asp">Microsoft Teams</a><br>
<a href="https://www.example-code.com/delphiDll/moodys.asp">Moody's</a><br>
<a href="https://www.example-code.com/delphiDll/okta_oauth_oidc.asp">Okta OAuth/OIDC</a><br>
<a href="https://www.example-code.com/delphiDll/onelogin_oidc.asp">OneLogin OIDC</a><br>
<a href="https://www.example-code.com/delphiDll/onenote.asp">OneNote</a><br>
<a href="https://www.example-code.com/delphiDll/openai.asp">OpenAI ChatGPT</a><br>
<a href="https://www.example-code.com/delphiDll/PRODA.asp">PRODA</a><br>
<a href="https://www.example-code.com/delphiDll/paypal.asp">PayPal</a><br>
<a href="https://www.example-code.com/delphiDll/paynow.asp">Paynow.pl</a><br>
<a href="https://www.example-code.com/delphiDll/peoplevox.asp">Peoplevox</a><br>
<a href="https://www.example-code.com/delphiDll/populi.asp">Populi</a><br>
<a href="https://www.example-code.com/delphiDll/quickbooks.asp">QuickBooks</a><br>
<a href="https://www.example-code.com/delphiDll/rabobank.asp">Rabobank</a><br>
<a href="https://www.example-code.com/delphiDll/refinitiv.asp">Refinitiv</a><br>
<a href="https://www.example-code.com/delphiDll/royalMail.asp">Royal Mail OBA</a><br>
<a href="https://www.example-code.com/delphiDll/scis.asp">SCiS Schools Catalogue</a><br>
<a href="https://www.example-code.com/delphiDll/sii.asp">SII Chile</a><br>
<a href="https://www.example-code.com/delphiDll/smsapi.asp">SMSAPI</a><br>
<a href="https://www.example-code.com/delphiDll/finkok.asp">SOAP finkok.com</a><br>
<a href="https://www.example-code.com/delphiDll/sendgrid.asp">SendGrid</a><br>
<a href="https://www.example-code.com/delphiDll/shippo.asp">Shippo</a><br>
<a href="https://www.example-code.com/delphiDll/shopify.asp">Shopify</a><br>
<a href="https://www.example-code.com/delphiDll/shopware.asp">Shopware</a><br>
<a href="https://www.example-code.com/delphiDll/shopware6.asp">Shopware 6</a><br>
<a href="https://www.example-code.com/delphiDll/simpletexting.asp">SimpleTexting</a><br>
<a href="https://www.example-code.com/delphiDll/square.asp">Square</a><br>
<a href="https://www.example-code.com/delphiDll/stripe.asp">Stripe</a><br>
<a href="https://www.example-code.com/delphiDll/sugarCRM.asp">SugarCRM</a><br>
<a href="https://www.example-code.com/delphiDll/ticketBAI.asp">TicketBAI</a><br>
<a href="https://www.example-code.com/delphiDll/trello.asp">Trello</a><br>
<a href="https://www.example-code.com/delphiDll/twilio.asp">Twilio</a><br>
<a href="https://www.example-code.com/delphiDll/twitter_v2.asp">Twitter API v2</a><br>
<a href="https://www.example-code.com/delphiDll/twitter.asp">Twitter v1</a><br>
<a href="https://www.example-code.com/delphiDll/ups.asp">UPS</a><br>
<a href="https://www.example-code.com/delphiDll/UniPin.asp">UniPin</a><br>
<a href="https://www.example-code.com/delphiDll/voicebase.asp">VoiceBase</a><br>
<a href="https://www.example-code.com/delphiDll/vonage.asp">Vonage</a><br>
<a href="https://www.example-code.com/delphiDll/watrend.asp">WaTrend</a><br>
<a href="https://www.example-code.com/delphiDll/walmart.asp">Walmart</a><br>
<a href="https://www.example-code.com/delphiDll/walmart_v3.asp">Walmart v3</a><br>
<a href="https://www.example-code.com/delphiDll/wasabi.asp">Wasabi</a><br>
<a href="https://www.example-code.com/delphiDll/whatsapp.asp">WhatsApp</a><br>
<a href="https://www.example-code.com/delphiDll/wix.asp">WiX</a><br>
<a href="https://www.example-code.com/delphiDll/woocommerce.asp">WooCommerce</a><br>
<a href="https://www.example-code.com/delphiDll/wordpress.asp">WordPress</a><br>
<a href="https://www.example-code.com/delphiDll/xero.asp">Xero</a><br>
<a href="https://www.example-code.com/delphiDll/yahooMail.asp">Yahoo Mail</a><br>
<a href="https://www.example-code.com/delphiDll/yapily.asp">Yapily</a><br>
<a href="https://www.example-code.com/delphiDll/yousign.asp">Yousign</a><br>
<a href="https://www.example-code.com/delphiDll/zatca.asp">ZATCA</a><br>
<a href="https://www.example-code.com/delphiDll/zendesk.asp">Zendesk</a><br>
<a href="https://www.example-code.com/delphiDll/zoom.asp">Zoom</a><br>
<a href="https://www.example-code.com/delphiDll/aaa_misc.asp">_Miscellaneous_</a><br>
<a href="https://www.example-code.com/delphiDll/ebay.asp">eBay</a><br>
<a href="https://www.example-code.com/delphiDll/effectconnect.asp">effectconnect</a><br>
<a href="https://www.example-code.com/delphiDll/hacienda_cr.asp">hacienda.go.cr</a><br>

</b></font></p>
<p></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
          </td>
        </tr>
      </tbody></table>
      
      
 
</td>
    <td valign="top"> 
      <h1><b>(Delphi DLL) DocuSign Add Documents to a Draft Envelope</b></h1>
      <h4>See more <a href="https://www.example-code.com/delphiDll/docusign.asp">DocuSign Examples</a></h4>
      <p>Demonstrates how to add one or more additional documents to a DocuSign draft envelope.</p><p>For more information, see <a href="https://developers.docusign.com/docs/esign-rest-api/reference/envelopes/envelopedocuments/updatelist/">https://developers.docusign.com/docs/esign-rest-api/reference/envelopes/envelopedocuments/updatelist/</a></p>
		<blockquote><table class="reference" width="500"><tbody><tr><td valign="top" colspan="3">
   <h2 id="subhdr">Chilkat for Delphi Downloads</h2>
		<p class="button"><a href="http://www.chilkatsoft.com/delphiDll.asp">Chilkat non-ActiveX DLL for Delphi</a></p>
		<p class="button"><a href="http://www.chilkatsoft.com/downloads_ActiveX.asp">Chilkat ActiveX DLL for Delphi</a></p>
		<p>* The examples here use the non-ActiveX DLL.</p>
   </td></tr>
</tbody></table>



</blockquote>
      <pre id="exCode"><span id="keyw">uses</span>
    Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
    Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Http, BinData, StringBuilder, HttpResponse, JsonObject;

...

<span id="keyw">procedure</span> TForm1.Button1Click(Sender: TObject);
<span id="keyw">var</span>
http: <a target="_top" href="https://www.chilkatsoft.com/refdoc/dd_CkHttpRef.html">HCkHttp</a>;
jsonToken: <a target="_top" href="https://www.chilkatsoft.com/refdoc/dd_CkJsonObjectRef.html">HCkJsonObject</a>;
success: <span id="keyw">Boolean</span>;
bd1: <a target="_top" href="https://www.chilkatsoft.com/refdoc/dd_CkBinDataRef.html">HCkBinData</a>;
bd2: <a target="_top" href="https://www.chilkatsoft.com/refdoc/dd_CkBinDataRef.html">HCkBinData</a>;
json: <a target="_top" href="https://www.chilkatsoft.com/refdoc/dd_CkJsonObjectRef.html">HCkJsonObject</a>;
i: <span id="keyw">Integer</span>;
sbJson: <a target="_top" href="https://www.chilkatsoft.com/refdoc/dd_CkStringBuilderRef.html">HCkStringBuilder</a>;
url: <span id="keyw">PWideChar</span>;
resp: <a target="_top" href="https://www.chilkatsoft.com/refdoc/dd_CkHttpResponseRef.html">HCkHttpResponse</a>;
jResp: <a target="_top" href="https://www.chilkatsoft.com/refdoc/dd_CkJsonObjectRef.html">HCkJsonObject</a>;
respStatusCode: <span id="keyw">Integer</span>;
documentId: <span id="keyw">PWideChar</span>;
documentIdGuid: <span id="keyw">PWideChar</span>;
name: <span id="keyw">PWideChar</span>;
v_type: <span id="keyw">PWideChar</span>;
uri: <span id="keyw">PWideChar</span>;
order: <span id="keyw">PWideChar</span>;
containsPdfFormFields: <span id="keyw">PWideChar</span>;
templateRequired: <span id="keyw">PWideChar</span>;
authoritativeCopy: <span id="keyw">PWideChar</span>;
envelopeId: <span id="keyw">PWideChar</span>;
count_i: <span id="keyw">Integer</span>;

<span id="keyw">begin</span>
<span id="cmt">// This example assumes the Chilkat API to have been previously unlocked.</span>
<span id="cmt">// See <a href="https://www.example-code.com/delphiDll/global_unlock.asp">Global Unlock Sample</a> for sample code.</span>

http := CkHttp_Create();

<span id="cmt">// Load a previously obtained OAuth2 access token.</span>
jsonToken := CkJsonObject_Create();
success := <span id="dtyp">CkJsonObject_LoadFile</span>(jsonToken,<span id="lit">'qa_data/tokens/docusign.json'</span>);
<span id="keyw">if</span> (success = <span id="lit">False</span>) <span id="keyw">then</span>
  <span id="keyw">begin</span>
    Memo1.Lines.Add(<span id="dtyp">CkJsonObject__lastErrorText</span>(jsonToken));
    Exit;
  <span id="keyw">end</span>;

<span id="cmt">// Adds the "Authorization: Bearer eyJ0eXAi.....UE8Kl_V8KroQ" header.</span>
<span id="dtyp">CkHttp_putAuthToken</span>(http,<span id="dtyp">CkJsonObject__stringOf</span>(jsonToken,<span id="lit">'access_token'</span>));

<span id="cmt">// Send the following request.</span>
<span id="cmt">// Make sure to use your own account ID (obtained from <a href="https://www.example-code.com/delphiDll/docusign_get_user_account_data.asp">Get Docusign User Account Information</a>)</span>

<span id="cmt">// PUT https://demo.docusign.net/restapi/v2.1/accounts/&lt;account ID&gt;/envelopes/&lt;envelope ID&gt;/documents HTTP/1.1</span>
<span id="cmt">// Expect: 100-continue</span>
<span id="cmt">// Accept: application/json</span>
<span id="cmt">// Cache-Control: no-cache</span>
<span id="cmt">// Authorization: Bearer eyJ0eX...</span>
<span id="cmt">// Content-Length: ...</span>
<span id="cmt">// Content-Type: application/json</span>
<span id="cmt">// </span>
<span id="cmt">// {</span>
<span id="cmt">// 	"documents": [</span>
<span id="cmt">// 		{</span>
<span id="cmt">// 		"documentId": "1",</span>
<span id="cmt">// 		"name": "hello.pdf",</span>
<span id="cmt">// 		"pages": "1",</span>
<span id="cmt">// 		"documentBase64": "&lt;insert base64 content here&gt;"</span>
<span id="cmt">// 		},</span>
<span id="cmt">// 		{</span>
<span id="cmt">// 		"documentId": "2",</span>
<span id="cmt">// 		"name": "hello2.pdf",</span>
<span id="cmt">// 		"pages": "1",</span>
<span id="cmt">// 		"documentBase64": "&lt;insert base64 content here&gt;"</span>
<span id="cmt">// 		}</span>
<span id="cmt">// 	]</span>
<span id="cmt">// }</span>

bd1 := CkBinData_Create();
success := <span id="dtyp">CkBinData_LoadFile</span>(bd1,<span id="lit">'qa_data/pdf/hello.pdf'</span>);
bd2 := CkBinData_Create();
success := <span id="dtyp">CkBinData_LoadFile</span>(bd2,<span id="lit">'qa_data/pdf/hello2.pdf'</span>);

json := CkJsonObject_Create();
i := <span id="lit">0</span>;
<span id="dtyp">CkJsonObject_putI</span>(json,i);
<span id="dtyp">CkJsonObject_UpdateString</span>(json,<span id="lit">'documents[i].documentId'</span>,<span id="lit">'1'</span>);
<span id="dtyp">CkJsonObject_UpdateString</span>(json,<span id="lit">'documents[i].name'</span>,<span id="lit">'hello.pdf'</span>);
<span id="dtyp">CkJsonObject_UpdateString</span>(json,<span id="lit">'documents[i].pages'</span>,<span id="lit">'1'</span>);
<span id="dtyp">CkJsonObject_UpdateString</span>(json,<span id="lit">'documents[i].documentBase64'</span>,<span id="dtyp">CkBinData__getEncoded</span>(bd1,<span id="lit">'base64'</span>));
i := i + <span id="lit">1</span>;
<span id="dtyp">CkJsonObject_putI</span>(json,i);
<span id="dtyp">CkJsonObject_UpdateString</span>(json,<span id="lit">'documents[i].documentId'</span>,<span id="lit">'2'</span>);
<span id="dtyp">CkJsonObject_UpdateString</span>(json,<span id="lit">'documents[i].name'</span>,<span id="lit">'hello2.pdf'</span>);
<span id="dtyp">CkJsonObject_UpdateString</span>(json,<span id="lit">'documents[i].pages'</span>,<span id="lit">'1'</span>);
<span id="dtyp">CkJsonObject_UpdateString</span>(json,<span id="lit">'documents[i].documentBase64'</span>,<span id="dtyp">CkBinData__getEncoded</span>(bd2,<span id="lit">'base64'</span>));

sbJson := CkStringBuilder_Create();
<span id="dtyp">CkJsonObject_putEmitCompact</span>(json,<span id="lit">False</span>);
<span id="dtyp">CkJsonObject_EmitSb</span>(json,sbJson);

<span id="dtyp">CkHttp_SetRequestHeader</span>(http,<span id="lit">'Expect'</span>,<span id="lit">'100-continue'</span>);
<span id="dtyp">CkHttp_SetRequestHeader</span>(http,<span id="lit">'Cache-Control'</span>,<span id="lit">'no-cache'</span>);
<span id="dtyp">CkHttp_SetRequestHeader</span>(http,<span id="lit">'Accept'</span>,<span id="lit">'application/json'</span>);

<span id="cmt">// Use your own account ID here.</span>
<span id="dtyp">CkHttp_SetUrlVar</span>(http,<span id="lit">'accountId'</span>,<span id="lit">'7f3f65ed-5e87-418d-94c1-92499ddc8252'</span>);
<span id="cmt">// Use the <a href="https://www.example-code.com/delphiDll/docusign_create_empty_envelope.asp">envelope ID returned by DocuSign when creating the draft envelope</a>).</span>
<span id="dtyp">CkHttp_SetUrlVar</span>(http,<span id="lit">'envelopeId'</span>,<span id="lit">'da9fb811-e6a4-48c0-a9fb-81ed18b989af'</span>);

url := <span id="lit">'https://demo.docusign.net/restapi/v2.1/accounts/{$accountId}/envelopes/{$envelopeId}/documents'</span>;
resp := <span id="dtyp">CkHttp_PTextSb</span>(http,<span id="lit">'PUT'</span>,url,sbJson,<span id="lit">'utf-8'</span>,<span id="lit">'application/json'</span>,<span id="lit">False</span>,<span id="lit">False</span>);
<span id="keyw">if</span> (<span id="dtyp">CkHttp_getLastMethodSuccess</span>(http) = <span id="lit">False</span>) <span id="keyw">then</span>
  <span id="keyw">begin</span>
    Memo1.Lines.Add(<span id="dtyp">CkHttp__lastErrorText</span>(http));
    Exit;
  <span id="keyw">end</span>;

jResp := CkJsonObject_Create();
<span id="dtyp">CkJsonObject_Load</span>(jResp,<span id="dtyp">CkHttpResponse__bodyStr</span>(resp));
<span id="dtyp">CkJsonObject_putEmitCompact</span>(jResp,<span id="lit">False</span>);

Memo1.Lines.Add(<span id="lit">'Response Body:'</span>);
Memo1.Lines.Add(<span id="dtyp">CkJsonObject__emit</span>(jResp));

<span id="cmt">// If you get a 401 response status code, it's likely you need to <a href="https://www.example-code.com/delphiDll/docusign_refresh_access_token.asp">refresh the DocuSign OAuth2 token</a>).</span>
respStatusCode := <span id="dtyp">CkHttpResponse_getStatusCode</span>(resp);
Memo1.Lines.Add(<span id="lit">'Response Status Code = '</span> + IntToStr(respStatusCode));
<span id="keyw">if</span> (respStatusCode &gt;= <span id="lit">400</span>) <span id="keyw">then</span>
  <span id="keyw">begin</span>
    Memo1.Lines.Add(<span id="lit">'Response Header:'</span>);
    Memo1.Lines.Add(<span id="dtyp">CkHttpResponse__header</span>(resp));
    Memo1.Lines.Add(<span id="lit">'Failed.'</span>);
    CkHttpResponse_Dispose(resp);
    Exit;
  <span id="keyw">end</span>;
CkHttpResponse_Dispose(resp);

<span id="cmt">// Sample JSON response:</span>
<span id="cmt">// (Sample code for parsing the JSON response is shown below)</span>

<span id="cmt">// {</span>
<span id="cmt">//   "envelopeId": "da9fb811-e6a4-48c0-a9fb-81ed18b989af",</span>
<span id="cmt">//   "envelopeDocuments": [</span>
<span id="cmt">//     {</span>
<span id="cmt">//       "documentId": "1",</span>
<span id="cmt">//       "documentIdGuid": "38e919fc-0a77-4b0c-9da0-e3530f4e6fc7",</span>
<span id="cmt">//       "name": "hello.pdf",</span>
<span id="cmt">//       "type": "content",</span>
<span id="cmt">//       "uri": "/envelopes/da9fb811-e6a4-48c0-a9fb-81ed18b989af/documents/1",</span>
<span id="cmt">//       "order": "3",</span>
<span id="cmt">//       "containsPdfFormFields": "false",</span>
<span id="cmt">//       "templateRequired": "false",</span>
<span id="cmt">//       "authoritativeCopy": "false"</span>
<span id="cmt">//     },</span>
<span id="cmt">//     {</span>
<span id="cmt">//       "documentId": "2",</span>
<span id="cmt">//       "documentIdGuid": "2cbd0fcc-c1ca-4a3a-b8b5-fe252dd89731",</span>
<span id="cmt">//       "name": "hello2.pdf",</span>
<span id="cmt">//       "type": "content",</span>
<span id="cmt">//       "uri": "/envelopes/da9fb811-e6a4-48c0-a9fb-81ed18b989af/documents/2",</span>
<span id="cmt">//       "order": "4",</span>
<span id="cmt">//       "containsPdfFormFields": "false",</span>
<span id="cmt">//       "templateRequired": "false",</span>
<span id="cmt">//       "authoritativeCopy": "false"</span>
<span id="cmt">//     }</span>
<span id="cmt">//   ]</span>
<span id="cmt">// }</span>

<span id="cmt">// Sample code for parsing the JSON response...</span>
<span id="cmt">// Use the following online tool to generate parsing code from sample JSON:</span>
<span id="cmt">// <a href="https://tools.chilkat.io/jsonParse.cshtml">Generate Parsing Code from JSON</a></span>

envelopeId := <span id="dtyp">CkJsonObject__stringOf</span>(jResp,<span id="lit">'envelopeId'</span>);
i := <span id="lit">0</span>;
count_i := <span id="dtyp">CkJsonObject_SizeOfArray</span>(jResp,<span id="lit">'envelopeDocuments'</span>);
<span id="keyw">while</span> i &lt; count_i <span id="keyw">do</span>
  <span id="keyw">begin</span>
    <span id="dtyp">CkJsonObject_putI</span>(jResp,i);
    documentId := <span id="dtyp">CkJsonObject__stringOf</span>(jResp,<span id="lit">'envelopeDocuments[i].documentId'</span>);
    documentIdGuid := <span id="dtyp">CkJsonObject__stringOf</span>(jResp,<span id="lit">'envelopeDocuments[i].documentIdGuid'</span>);
    name := <span id="dtyp">CkJsonObject__stringOf</span>(jResp,<span id="lit">'envelopeDocuments[i].name'</span>);
    v_type := <span id="dtyp">CkJsonObject__stringOf</span>(jResp,<span id="lit">'envelopeDocuments[i].type'</span>);
    uri := <span id="dtyp">CkJsonObject__stringOf</span>(jResp,<span id="lit">'envelopeDocuments[i].uri'</span>);
    order := <span id="dtyp">CkJsonObject__stringOf</span>(jResp,<span id="lit">'envelopeDocuments[i].order'</span>);
    containsPdfFormFields := <span id="dtyp">CkJsonObject__stringOf</span>(jResp,<span id="lit">'envelopeDocuments[i].containsPdfFormFields'</span>);
    templateRequired := <span id="dtyp">CkJsonObject__stringOf</span>(jResp,<span id="lit">'envelopeDocuments[i].templateRequired'</span>);
    authoritativeCopy := <span id="dtyp">CkJsonObject__stringOf</span>(jResp,<span id="lit">'envelopeDocuments[i].authoritativeCopy'</span>);
    i := i + <span id="lit">1</span>;
  <span id="keyw">end</span>;

CkHttp_Dispose(http);
CkJsonObject_Dispose(jsonToken);
CkBinData_Dispose(bd1);
CkBinData_Dispose(bd2);
CkJsonObject_Dispose(json);
CkStringBuilder_Dispose(sbJson);
CkJsonObject_Dispose(jResp);

<span id="keyw">end</span>;

</pre>
    </td>
  </tr>
</tbody></table>

<table width="100%" border="0" cellspacing="0" cellpadding="3" bgcolor="#7F2AB2">
  <tbody><tr>
    <td>&nbsp; </td>
  </tr>
</tbody></table>

<p align="center"><font size="1" color="#999999">© 
  2000-2023 Chilkat Software, Inc. All Rights Reserved.</font></p>
 


</body></html>